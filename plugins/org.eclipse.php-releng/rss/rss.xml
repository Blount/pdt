<?xml version="1.0" encoding="UTF-8"?>
<project name="RssUtitlities" default="nodefault">
	<target name="nodefault">
	</target>

	<taskdef name="RssAddProject" classname="rss2ant.RssAddProject" />
	<taskdef name="RssAddCenter" classname="rss2ant.RssAddCenter" />
	<taskdef name="RssSendMessage" classname="rss2ant.RssSendMessage" />
	<taskdef name="RssGenerator" classname="rss2ant.RssGenerator" />

	<property name="rssProjectName" value="PDT" />
	<property name="rssCenterName" value="blackboard " />
	<property name="rssCenterDescription" value="This is a blackboard center to ${rssProjectName}" />
	<property name="rssCenterAbout" value="" />
	<property name="rssTitle" value="error! set a message here" />
	<property name="rssMessageDescription" value="" />
	<property name="rssMessageContributor" value="PHP Build Server" />
	<property name="rssMessageLink" value="http://download.eclipse.org/tools/php/downloads/index.php" />
	<property name="rssOutputFile" value="updates.xml" />

	<target name="createProject">
		<RssAddProject projectName="${rssProjectName}" />
	</target>

	<target name="createCenter">
		<RssAddCenter projectName="${rssProjectName}" centerName="${rssCenterName}" description="${rssCenterDescription}" about="${rssCenterAbout}" link="http://www.eclipse.org/php" />
	</target>

	<target name="addMessage">
		<loadfile property="description" srcFile="content"/>
		<RssSendMessage projectName="${rssProjectName}" centerName="${rssCenterName}" title="${rssTitle}" link="${rssMessageLink}" description="${description}" contibutor="${rssMessageContributor}" />
	</target>

	<target name="generateRss">
		<RssGenerator projectName="${rssProjectName}" centerName="${rssCenterName}" xmlFilename="${rssOutputFile}" />
	</target>

	<target name="uploadRss">
		<property name="source" value="${rssOutputFile}" />
		<property name="target" value="rss/updates.xml" />

		<exec dir="." executable="rsync">
			<arg line="-avz --password-file=$HOME/.pass --stats ${source} apeled@dev.eclipse.org:/home/data/httpd/download.eclipse.org/tools/php/downloads/${target}" />
		</exec>
	</target>

	<target name="mailUnitTestResults">
		<tstamp />
		<property name="date" value="${DSTAMP}" />
		<property name="time" value="${TSTAMP}" />
		<property name="timestamp" value="${date} ${time}" />
		<mail from="pdt-unit-test@eclipse.org" encoding="uu" tolist="roy@zend.com;" files="../src/results/html/all/TEST-php.html" subject="[Unit-Test Results] Build ${timestamp}" />
	</target>

	<target name="getTestResults">
		<xslt in="../src/results/xml/all/TEST-php.xml" out="content" style="style.xsl">
			<outputproperty name="method" value="text" />
			<outputproperty name="omit-xml-declaration" value="yes" />			
			<outputproperty name="indent" value="no" />
		</xslt>
	</target>
</project>
