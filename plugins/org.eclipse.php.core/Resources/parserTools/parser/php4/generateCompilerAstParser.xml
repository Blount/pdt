<project name="Generates Compiler AST Parser for PHP 4" default="generateParser" basedir=".">
	
	<target name="checkUpToDate">
		<uptodate
			property="upToDate"
			srcfile="php_compiler_ast_parser.cup"
			targetfile="../../../../src/org/eclipse/php/internal/core/compiler/ast/parser/php4/CompilerAstParser.java" />
	</target>

	<target name="generateParser" depends="checkUpToDate" unless="upToDate">
		<java 
			classpath="../../../../bin"
			classname="java_cup.Main"
			input="php_compiler_ast_parser.cup"
			fork="true">
			
			<arg value="-compact_red"/>
			<arg value="-expect"/>
			<arg value="4"/>
			<arg value="-parser"/>
			<arg value="CompilerAstParser"/>
			<arg value="-symbols"/>
			<arg value="CompilerParserConstants"/>
			<arg value="-interface"/>
		</java>
		
		<replace
			file="CompilerAstParser.java"
			token="extends java_cup.runtime.lr_parser"
			value="extends AbstractASTParser"/>

		<move
			file="CompilerAstParser.java"
			todir="../../../../src/org/eclipse/php/internal/core/compiler/ast/parser/php4"/>

		<move
			file="CompilerParserConstants.java"
			todir="../../../../src/org/eclipse/php/internal/core/compiler/ast/parser/php4"/>

	</target>

</project>
